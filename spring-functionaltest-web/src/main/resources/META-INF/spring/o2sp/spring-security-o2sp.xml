<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:sec="http://www.springframework.org/schema/security"
  xmlns:context="http://www.springframework.org/schema/context"
  xsi:schemaLocation="http://www.springframework.org/schema/security https://www.springframework.org/schema/security/spring-security.xsd
        http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">

  <sec:http pattern="/o2sp/**" once-per-request="false">
    <sec:form-login />
    <sec:logout />
    <sec:oauth2-client />
  </sec:http>

  <sec:client-registrations>
    <sec:client-registration
      registration-id="registration_read"
      client-id="readClient"
      client-secret="secret"
      authorization-grant-type="authorization_code"
      redirect-uri="{baseUrl}/o2sp/authorized"
      scope="READ"
      provider-id="provider_1" />
    <sec:client-registration
      registration-id="registration_wrong"
      client-id="readClient"
      client-secret="secret"
      authorization-grant-type="authorization_code"
      redirect-uri="{baseUrl}/o2sp/authorized"
      scope="CREATE"
      provider-id="provider_1" />
    <sec:client-registration
      registration-id="registration_all"
      client-id="testClient"
      client-secret="secret"
      authorization-grant-type="authorization_code"
      redirect-uri="{baseUrl}/o2sp/authorized"
      scope="READ,UPDATE,CREATE,DELETE"
      provider-id="provider_1" />
    <sec:client-registration
      registration-id="registration_partial"
      client-id="testClient"
      client-secret="secret"
      authorization-grant-type="authorization_code"
      redirect-uri="{baseUrl}/o2sp/authorized"
      scope="READ,DELETE"
      provider-id="provider_1" />
    <sec:provider
      provider-id="provider_1"
      authorization-uri="https://dev-1234.oktapreview.com/oauth2/v1/authorize"
      token-uri="https://dev-1234.oktapreview.com/oauth2/v1/token" />
  </sec:client-registrations>

  <!-- RestTemplate -->
  <bean id="restOperations" class="org.springframework.web.client.RestTemplate">
    <property name="requestFactory">
      <bean class="org.springframework.http.client.SimpleClientHttpRequestFactory">
        <property name="connectTimeout" value="${o2sp.resource.connection.timeout:10000}" />
        <property name="readTimeout" value="${o2sp.resource.read.timeout:10000}" />
      </bean>
    </property>
  </bean>
</beans>